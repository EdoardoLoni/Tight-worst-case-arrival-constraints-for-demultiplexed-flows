# Tight Worst-Case Arrival Constraints for Demultiplexed Flows

This repository provides an open-source example implementation of the method proposed in the paper:

**“Tight Worst-Case Arrival Constraints for Demultiplexed Flows (Loni, Zippo, Stea, Andreozzi)”**

The implementation demonstrates how to compute tight worst-case arrival curves for individual flows obtained from the demultiplexing of an aggregate, using Deterministic Network Calculus (DNC) and structural information on the demultiplexing scheme.

## Overview

In many real-time systems, traffic generated by a source is demultiplexed into multiple flows destined to different resources or paths. 
While the aggregate traffic may be constrained by a known arrival curve, directly applying this constraint to each individual flow leads to overly pessimistic worst-case bounds.

The method implemented in this repository derives **tight worst-case arrival constraints** for an individual flow, i.e. the  *Type of Interest (ToI) flow* demultiplexed from an aggregate, by leveraging:
- the arrival curve of the aggregate flow, and
- spatial characterization of how traffic is arranged within each cycle of the aggregate.

The repository includes a notebook that implements and illustrates the three variants of the proposed method:
- **Basic**
- **Offset-aware**
- **Subset-aware**

## Repository Contents

The [example_implementation.dib](./example_implementation.dib) notebook contains
  - the implementation of the method to compute ToI arrival curves introduced in the paper;
  - a numerical example corresponding to the one presented in the paper.

It can be run using the [Polyglot Notebooks](https://code.visualstudio.com/docs/languages/polyglot) extension for VS Code.

The notebook is intended as a reference implementation and illustrative example, rather than as a fully packaged analysis tool.
However, its code is reusable, and the methods can be copied and reused as-is in any C# project, outside the Polyglot Notebook environment.

### Implemented Methods

The notebook implements the following key functions:

- **Basic method**  
  Computes the maximum spatial arrangement curve  
  $\Omega_{M,\mathrm{toi}}(b)$  
  as defined in *Theorem 4*, given:
  - minimum cycle length $N^{\min}$,
  - maximum ToI traffic per cycle $N^{\max}_{\mathrm{toi}}$.

- **Offset-aware method**  
  Computes $\Omega_{M,\mathrm{toi}}(b)$ as in *Theorem 9*, additionally exploiting:
  - minimum and maximum offsets of non-ToI traffic within the cycle.

- **Subset-aware method**  
  Computes $\Omega_{M,\mathrm{toi}}(b)$ as in *Theorems 12 and 13*, by:
  - modeling ToI traffic as appearing in multiple subsets within a cycle,
  - computing subset-wise spatial arrangement curves, and
  - taking their maximum.

- **Arrival curve derivation**  
  For all methods, the ToI arrival curve is obtained by composing the aggregate arrival curve with the corresponding maximum spatial arrangement curve, as stated in *Theorems 8, 11, and 14*.

Note that this methods can be copied and reused as-is in any C# project, outside the Polyglot Notebook environment.

### Numerical Example

The notebook includes a complete numerical example that matches the parameter configuration presented in **Section 6** of the paper.

Specifically:
- the aggregate traffic is constrained by a leaky-bucket arrival curve,
- cycle parameters and spatial constraints are instantiated,
- arrival curves for the Flow of Interest are computed and plotted for:
  - the basic method,
  - the offset-aware method, and
  - the subset-aware method.

The example highlights the progressive tightening of worst-case bounds obtained by incorporating additional structural information.

## Requirements

Using [Polyglot Notebooks](https://code.visualstudio.com/docs/setup/vscode-web#_extensions) require [VS Code](https://code.visualstudio.com/Download) and the [.NET SDK](https://dotnet.microsoft.com/en-us/download) to be installed.

The [example_implementation.dib](./example_implementation.dib) notebook uses the Nuget package [Unipi.Nancy.Interactive](https://www.nuget.org/packages/Unipi.Nancy.Interactive), which is automatically downloaded on first run.

> **Note**  
> At the time of writing, the first execution of the first code cell may produce a `kernel initialization error`. Re-running the cell resolves the issue.
